Object.defineProperty(exports,"__esModule",{value:true});exports.getDirections=getDirections;exports.googleMapNavigate=googleMapNavigate;exports.decodeMapPoints=decodeMapPoints;exports.calculateDistance=calculateDistance;var _RestClient=require('./RestClient');var _RestClient2=_interopRequireDefault(_RestClient);var _constants=require('../constants');var _constants2=_interopRequireDefault(_constants);var _Idx=require('./Idx');var _Idx2=_interopRequireDefault(_Idx);var _reactNative=require('react-native');function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function getDirections(source,destination){return new Promise(function(fulfill,reject){var directionsUrl='https://maps.googleapis.com/maps/api/directions/json?origin='+source.latitude+','+source.longitude+'&destination='+destination.latitude+','+destination.longitude+'&key='+_constants2.default.GoogleAPIKey;fetch(directionsUrl).then(function(response){return response.json();}).then(function(responseJson){if(responseJson.status==='OK'){var directionArray=[];var steps=[];if((0,_Idx2.default)(responseJson,function(_){return _.routes[0].legs[0].steps;})){steps=responseJson.routes[0].legs[0].steps;}if(responseJson.routes.length){var _steps=decodeMapPoints(responseJson.routes[0].overview_polyline.points);return fulfill(_steps);}}else{reject();}}).catch(function(error){reject();});});}function googleMapNavigate(source,destination){var url='';url='http://maps.google.com/maps?saddr='+source.latitude+','+source.longitude+'&daddr='+destination.latitude+','+destination.longitude;console.log("URL ",url);_reactNative.Linking.canOpenURL(url).then(function(supported){if(!supported){console.log('Error',url);}else{_reactNative.Linking.openURL(url);}});}function decodeMapPoints(t,e){for(var n,o,u=0,l=0,r=0,d=[],h=0,i=0,a=null,c=Math.pow(10,e||5);u<t.length;){a=null,h=0,i=0;do{a=t.charCodeAt(u++)-63,i|=(31&a)<<h,h+=5;}while(a>=32);n=1&i?~(i>>1):i>>1,h=i=0;do{a=t.charCodeAt(u++)-63,i|=(31&a)<<h,h+=5;}while(a>=32);o=1&i?~(i>>1):i>>1,l+=n,r+=o,d.push([l/c,r/c]);}return d=d.map(function(t){return{latitude:t[0],longitude:t[1]};});}function calculateDistance(source,destination){var unit="N";var radlat1=Math.PI*source.lat/180;var radlat2=Math.PI*destination.lat/180;var theta=source.lng-destination.lng;var radtheta=Math.PI*theta/180;var dist=Math.sin(radlat1)*Math.sin(radlat2)+Math.cos(radlat1)*Math.cos(radlat2)*Math.cos(radtheta);dist=Math.acos(dist);dist=dist*180/Math.PI;dist=dist*60*1.1515;if(unit=="K"){dist=dist*1.609344;}if(unit=="N"){dist=dist*0.8684;}return dist.toFixed(1);}